---
title: "Psychological impact of Covid-19"
output:
  rmdformats::material:
    highlight: tango
    code_folding: show
    thumbnails:   TRUE
    gallery: TRUE
    fig_width: 6
    fig_height: 4
    cards: TRUE
---

```{r setup, include=FALSE}
library(knitr)
library(rmdformats)

# Global options
knitr::opts_chunk$set(echo = TRUE)
options(max.print="100")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=100)
```

```{r}
library(pacman)
p_load(qualtRics, tidyverse,ggrepel,stringr, multicon, psych,ggthemes,
       dplyr,plyr,modelr,plotly,sf,rworldmap,RColorBrewer,data.table,
       rmdformats)
```

# Preamble

![](./img/covid.JPG)

Analysis of the **psychological effects of Covid-19** in Europe during the first weeks of the pandemic.The survey on which this study is based was conducted by international researchers around the world, trying to map out all the factors, that might affects people’s psychological wellbeing and their ability to make good decisions during the COVID-19 (or "Coronavirus") outbreak. Researchers from many countries are collaborating on this project, to help scientists and decision makers to help and communicate.

## Why this project?

The project was chosen as it deals with analyzing all the factors that in this emergency situation can have **threatening consequences** in people's lives: the isolation, the economic situation and the stress due to the stringent measures to stop the pandemic are part of the side effects of covid-19.
The survey on which the next analyzes are based was designed by social scientists and psychologists from more than 50 different universities.
The study in question presents more than 150,000 individual respondents from more than 50 different countries.
The following analyzes describe a series of variables selected in the survey, taking as a sample the responses provided by citizens located in Europe who answered the survey between March 30, 2020 and May 30, 2020.

For more informations check [this](https://www.nature.com/articles/s41597-020-00784-9) **Nature** article.
```{r}
#load survey data
d <- read_survey("csv-choice.csv")
```


```{r}
# filter out participants who did not provide their age here!
d <- filter(d, Consent == "Yes") %>% 
  filter(Dem_age >= 18)
```

```{r}
#The marital status variable was mixed up, with the exception of English. The variable was recoded to correct for that problem.
# Load function 'recode_if'(Aden-Buie & Gerke, 2018)
recode_if <- function(x, condition, ...) {
  if_else(condition, recode(x, ...), x)
}

# Fix differences in scoring between English and other languages 
d <- d %>%
  mutate(Dem_maritalstatus = 
           recode_if(Dem_maritalstatus, UserLanguage != "EN", 
                     "Single" = "Other or would rather not say",
                     "Married/cohabiting" = "Single",
                     "Divorced/widowed"= "Married/cohabiting",
                     "Other or would rather not say" = "Divorced/widowed"))

```

```{r}

#Remove dashes in front of the response options
d$Dem_edu <- str_remove(d$Dem_edu, "- ")
d$Dem_edu_mom <- str_remove(d$Dem_edu_mom, "- ")
```

```{r}
#There were some participants who had “1” in Dem_edu. These responses were recoded as “Uninformative response”
#Recode 1 as Uninformative responses
d$Dem_edu <- str_replace(d$Dem_edu, "^1", "Uninformative response")
d$Dem_edu_mom <- str_replace(d$Dem_edu_mom, "^1", "Uninformative response")
```

```{r}
#The variable Dem_gender in Spain & Mexico was inverted – Male was recorded as Female and vice versa. Thus, the variable was recoded for SSP (Espanol - Espana) and SME (Espanol - Mexico)
d <- d %>% 
  mutate(Dem_gender = ifelse(UserLanguage %in% c("SSP", "SME"),
                             case_when(Dem_gender == "Female" ~ "Male",
                                       Dem_gender == "Male" ~ "Female",
                                       Dem_gender == "Other/would rather not say" ~ "Other/would rather not say"),
                             Dem_gender))
```

```{r}
#Recode AD_Check, AD_gain and AD_loss (shorten the response and turn the character to factor)
d <- d %>% 
  mutate(AD_gain = factor(recode(AD_gain, 
                                 "· If Program A is adopted, 200 people will be saved." = "Program A",
                                 "· If Program B is adopted, there is 1/3 probability that 600 people will be saved, and 2/3 probability that no people will be saved" = "Program B")),
         AD_loss = factor(recode(AD_loss, 
                                 "· If Program C is adopted 400 people will die." = "Program C",
                                 "· If Program D is adopted there is 1/3 probability that nobody will die, and 2/3 probability that 600 people will die." = "Program D")),
         AD_check = factor(AD_check))
```

```{r}
#Convert scale responses to numeric
#PSS10
d <- d %>% mutate_at(
  .vars = vars(contains("PSS10")),
  .funs = recode, 
  "Never" = 1, 
  "Almost never" = 2,
  "Sometimes" = 3, 
  "Fairly often" = 4,
  "Very often" = 5
)
```

```{r}
#Corona_concerns, Compliance, BFF, SPS, Coping, Expl_media
d <- d %>% mutate_at(
  .vars = vars(matches("Corona_concerns|Compliance|BFF|SPS|Coping_\\d|Expl_media")),
  .funs = recode, 
  "Strongly disagree" = 1, 
  "Disagree" = 2,
  "Slightly disagree" = 3, 
  "Slightly agree" = 4,
  "Agree" = 5,
  "Strongly agree" = 6
)
```

```{r}
#Distress scale
#note: 99 is “Does not apply to my current situation”
d <- d %>% mutate_at(
  .vars = vars(matches("Distress_\\d")),
  .funs = recode, 
  "Strongly disagree" = 1, 
  "Disagree" = 2,
  "Slightly disagree" = 3, 
  "Slightly agree" = 4,
  "Agree" = 5,
  "Strongly agree" = 6,
  "Does not apply to my current situation" = 99
)
```

```{r}
#Trust in the country’s measures
#Take care that this scale is coded in such a way that both 0 and 10 are defined as “not appropriate” (either too little or too much) and 5 is defined as appropriate.
# Recoding Trust_country measure
d <- d %>% mutate(
  Trust_countrymeasure = recode(Trust_countrymeasure,
                                "Too little" = 0,
                                "1" = 1,
                                "2" = 2,
                                "3" = 3,
                                "4" = 4,
                                "Appropriate" = 5,
                                "6" = 6,
                                "7" = 7,
                                "8" = 8,
                                "9" = 9,
                                "Too much" = 10))
```

```{r}
#Rename the PSS10_11 through PSS10_13 to Perceived loneliness (SLON-3)
#PSS10_11 to PSS10_13 are actually the Perceived loneliness items
d <- d %>% 
  rename("Scale_SLON_1" = Scale_PSS10_UCLA_11,
         "Scale_SLON_2" = Scale_PSS10_UCLA_12,
         "Scale_SLON_3" = Scale_PSS10_UCLA_13) 
```

```{r}
#cleaned dataset (beta)
cleaned_d <- d[, c(5, 7, 10, 12:151)]
```

# Characteristics of the Respondents

As said in the **'Preamble'** this project is focuses on the responses provided by citizens located in Europe's countries.
```{r EU, echo=TRUE}
#filtering by EU Countries
target <- c("Austria","Belgium","Bulgaria","Croatia","Cyprus","Czech Republic",
            "Denmark","Estonia","Finland","France","Germany","Greece","Hungary",
            "Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta",
            "Netherlands","Poland","Portugal","Romania","Slovakia","Slovenia",
            "Spain","Sweden")

EU <- filter(cleaned_d, Country %in% target) 

#fixing date visualization
EU$RecordedDate <- as.Date(EU$RecordedDate , format= "%Y-%m-%d")
```

The majority of respondents are aged between **20** years old and **40** years old.
```{r age, fig.cap="Age of the Respondents", fig.align='center'}
#note: Missing values are omitted
ggplot(subset(EU, !is.na(Dem_age)),aes(Dem_age))+
  geom_bar(fill= "#006978")+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(x = "Age")+
  xlim(18,99)+
  theme(axis.title.y=element_blank(),axis.title.x = element_text(margin = margin(t=5)),
        axis.text.y = element_text(size=10, hjust = 1))
```

The majority of the answers come from **women**.
```{r gendeer, fig.cap="Gender of the Respondents", fig.align='center'}
#note: Missing values are omitted
gnd <-count(EU$Dem_gender)
 gnd = gnd[-4, ] 

 plot_ly(gnd, labels = ~x, values = ~freq,direction ='clockwise',
          marker = list(colors = c('#003E4C','#1A515E','#346470')),type = 'pie') %>%
   layout(xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
          yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
```

**Full time employed** lead the survey.
```{r empl, fig.cap="Employment of the Respondents", fig.align='center'}
#Missing values are omitted
empl <-count(EU$Dem_employment)
empl =empl[-7, ] 

plot_ly(empl, labels = ~x, values = ~freq,direction ='clockwise',
        marker = list(colors = c('#003E4C','#688A94','#829DA6','#4E7782','#346470','#1A515E')), type = 'pie') %>%
  layout(xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))

```

# Stress level in Europe

An important point of the project is based on the analysis of **perceived individual stress**, obtained through the PSS Scale, based on the answers to 10 questions, invented by psychologists Cohen, Karmak, and Mermelstrein (1983), using indicators of stress responses, for instance, perceived lack of control over events, pressure from mounting difficulties and feeling upset about unexpected changes. Scores are considered moderate above 2.4, and high above 3.7.
More informations about **PSS Scale** [here](https://www.midss.org/content/perceived-stress-scale-pss)

PSS scores are obtained by reversing responses (e.g., 0 = 4, 1 = 3, 2 = 2, 3 = 1 & 4 = 0) to the four positively stated items (items 4, 5, 7, & 8) and then summing across all scale items. A short 4 item scale can be made from questions 2, 4, 5 and 10 of the PSS 10 item scale.

```{r stress, echo=TRUE}
#note that the na values are omitted
EU$Scale_PSS10_UCLA_4[EU$Scale_PSS10_UCLA_4 == 1] <- 5
EU$Scale_PSS10_UCLA_4[EU$Scale_PSS10_UCLA_4 == 2] <- 4
EU$Scale_PSS10_UCLA_4[EU$Scale_PSS10_UCLA_4 == 4] <- 2
EU$Scale_PSS10_UCLA_4[EU$Scale_PSS10_UCLA_4 == 5] <- 1
EU$Scale_PSS10_UCLA_5[EU$Scale_PSS10_UCLA_5 == 1] <- 5
EU$Scale_PSS10_UCLA_5[EU$Scale_PSS10_UCLA_5 == 2] <- 4
EU$Scale_PSS10_UCLA_5[EU$Scale_PSS10_UCLA_5 == 4] <- 2
EU$Scale_PSS10_UCLA_5[EU$Scale_PSS10_UCLA_5 == 5] <- 1
EU$Scale_PSS10_UCLA_7[EU$Scale_PSS10_UCLA_7 == 1] <- 5
EU$Scale_PSS10_UCLA_7[EU$Scale_PSS10_UCLA_7 == 2] <- 4
EU$Scale_PSS10_UCLA_7[EU$Scale_PSS10_UCLA_7 == 4] <- 2
EU$Scale_PSS10_UCLA_7[EU$Scale_PSS10_UCLA_7 == 5] <- 1
EU$Scale_PSS10_UCLA_8[EU$Scale_PSS10_UCLA_8 == 1] <- 5
EU$Scale_PSS10_UCLA_8[EU$Scale_PSS10_UCLA_8 == 2] <- 4
EU$Scale_PSS10_UCLA_8[EU$Scale_PSS10_UCLA_8 == 4] <- 2
EU$Scale_PSS10_UCLA_8[EU$Scale_PSS10_UCLA_8 == 5] <- 1

eu_stress <- select(EU,Country, Scale_PSS10_UCLA_1:Scale_PSS10_UCLA_10) %>%
  ddply( .(Country), summarize,
         Rate_PSS10_UCLA1=mean(Scale_PSS10_UCLA_1,na.rm=TRUE),
         Rate_PSS10_UCLA2=mean(Scale_PSS10_UCLA_2,na.rm=TRUE),
         Rate_PSS10_UCLA3=mean(Scale_PSS10_UCLA_3,na.rm=TRUE),
         Rate_PSS10_UCLA4=mean(Scale_PSS10_UCLA_4,na.rm=TRUE),
         Rate_PSS10_UCLA5=mean(Scale_PSS10_UCLA_5,na.rm=TRUE),
         Rate_PSS10_UCLA6=mean(Scale_PSS10_UCLA_6,na.rm=TRUE),
         Rate_PSS10_UCLA7=mean(Scale_PSS10_UCLA_7,na.rm=TRUE),
         Rate_PSS10_UCLA8=mean(Scale_PSS10_UCLA_8,na.rm=TRUE),
         Rate_PSS10_UCLA9=mean(Scale_PSS10_UCLA_9,na.rm=TRUE),
         Rate_PSS10_UCLA10=mean(Scale_PSS10_UCLA_10,na.rm=TRUE))%>%
  mutate(total_stress = rowMeans(select(., -Country)))
```

```{r stressplot, fig.cap="Level of stress by Country", fig.align='center'}
ggplot(eu_stress, aes(reorder(Country, total_stress), total_stress)) +
  geom_col(fill= "#006978")+
  ylim(0,5)+
  coord_flip()+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y = "Mean of stress levels")+
  theme(axis.title.y=element_blank(),
        axis.text.x = element_text( size = 8), axis.line.y = element_line(size = 0.5),
        axis.text.y = element_text(size=10, hjust = 1))

```
Levels of stress were **moderate or lower** in many countries. Poland and Croatia reported the highest levels of stress in Europe, Denmark and Netherlands the lowest.

## Are men or women more stressed?
```{r genderstress, echo=TRUE}
eu_stress_gender <- select(filter(EU,Dem_gender=="Male" | Dem_gender=="Female"), Dem_gender,
                           Scale_PSS10_UCLA_1:Scale_PSS10_UCLA_10) %>%
  ddply( .(Dem_gender), summarize,
         Rate_PSS10_UCLA1=mean(Scale_PSS10_UCLA_1,na.rm=TRUE),
         Rate_PSS10_UCLA2=mean(Scale_PSS10_UCLA_2,na.rm=TRUE),
         Rate_PSS10_UCLA3=mean(Scale_PSS10_UCLA_3,na.rm=TRUE),
         Rate_PSS10_UCLA4=mean(Scale_PSS10_UCLA_4,na.rm=TRUE),
         Rate_PSS10_UCLA5=mean(Scale_PSS10_UCLA_5,na.rm=TRUE),
         Rate_PSS10_UCLA6=mean(Scale_PSS10_UCLA_6,na.rm=TRUE),
         Rate_PSS10_UCLA7=mean(Scale_PSS10_UCLA_7,na.rm=TRUE),
         Rate_PSS10_UCLA8=mean(Scale_PSS10_UCLA_8,na.rm=TRUE),
         Rate_PSS10_UCLA9=mean(Scale_PSS10_UCLA_9,na.rm=TRUE),
         Rate_PSS10_UCLA10=mean(Scale_PSS10_UCLA_10,na.rm=TRUE))%>%
  mutate(total_stress = rowMeans(select(., -Dem_gender)))
```

```{r genderstressplot, fig.cap="Levels of stress by Gender", fig.align='center'}
ggplot(eu_stress_gender, aes(Dem_gender, total_stress)) + 
  geom_point(size=7) + 
  geom_segment(aes(x=Dem_gender, 
                   xend=Dem_gender, 
                   y=0, 
                   yend=total_stress)) + 
  ylim(0,4)+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y = "Mean of stress levels")+
  theme(axis.title.y = element_text(margin=margin(r=5), hjust = 0.5, size=10),axis.title.x=element_blank(),
        axis.text.x = element_text(angle=65, vjust=0.6, size = 10), axis.line.y = element_line(size = 0.5),
        axis.text.y = element_text(size=10,vjust=0.5,hjust = 1.25))
```
From what emerges **women** results more stressed then men.
In line with [this](https://psycnet.apa.org/record/1999-10525-006)
Psychological article.

## Which is the most stressed employment?
```{r stress employment, echo=TRUE}
eu_stress_empl <- select(EU, Dem_employment,Scale_PSS10_UCLA_1:Scale_PSS10_UCLA_10) %>%
  ddply( .(Dem_employment), summarize,
         Rate_PSS10_UCLA1=mean(Scale_PSS10_UCLA_1,na.rm=TRUE),
         Rate_PSS10_UCLA2=mean(Scale_PSS10_UCLA_2,na.rm=TRUE),
         Rate_PSS10_UCLA3=mean(Scale_PSS10_UCLA_3,na.rm=TRUE),
         Rate_PSS10_UCLA4=mean(Scale_PSS10_UCLA_4,na.rm=TRUE),
         Rate_PSS10_UCLA5=mean(Scale_PSS10_UCLA_5,na.rm=TRUE),
         Rate_PSS10_UCLA6=mean(Scale_PSS10_UCLA_6,na.rm=TRUE),
         Rate_PSS10_UCLA7=mean(Scale_PSS10_UCLA_7,na.rm=TRUE),
         Rate_PSS10_UCLA8=mean(Scale_PSS10_UCLA_8,na.rm=TRUE),
         Rate_PSS10_UCLA9=mean(Scale_PSS10_UCLA_9,na.rm=TRUE),
         Rate_PSS10_UCLA10=mean(Scale_PSS10_UCLA_10,na.rm=TRUE))%>%
  mutate(total_stress = rowMeans(select(., -Dem_employment)))
```

```{r stress employment plot, fig.cap="Stress level by employment"}
ggplot(data=subset(eu_stress_empl, !is.na(Dem_employment)),
       aes(Dem_employment, total_stress)) + 
  geom_point(size=7) + 
  geom_segment(aes(x=Dem_employment, 
                   xend=Dem_employment, 
                   y=0, 
                   yend=total_stress)) + 
  ylim(0,4)+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y = "Mean of stress levels")+
  theme(axis.title.y = element_text(margin=margin(r=5), hjust = 0.5, size=10),axis.title.x=element_blank(),
        axis.text.x = element_text(angle=50, vjust=0.6, size = 10, margin = margin(t=15)), axis.line.y = element_line(size = 0.5),
        axis.text.y = element_text(size=10,vjust=0.5,hjust = 1.25))
```
The most stressed category is the one of the **students**, as expected, due to isolation and social distancing. 
[This](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7532061/) article stated that Polish University's students recorded an higher level of stress during the Covid-19 pandemic. Notably, Poland is also the most stressed Country.

## How stress level changed in Europe during the first weeks of Covid pandemic?
```{r stressduringtime, echo=TRUE}
eu_stress_2months <- select(filter(EU,RecordedDate=="2020-03-30"|
                                     RecordedDate=="2020-04-06"|
                                     RecordedDate=="2020-04-12"|
                                     RecordedDate=="2020-04-18"|
                                     RecordedDate=="2020-04-24"|
                                     RecordedDate=="2020-04-30"|
                                     RecordedDate=="2020-05-05"|
                                     RecordedDate=="2020-05-11"|
                                     RecordedDate=="2020-05-17"|
                                     RecordedDate=="2020-05-23"|
                                     RecordedDate=="2020-05-30"), 
                            RecordedDate,Scale_PSS10_UCLA_1:Scale_PSS10_UCLA_10) %>%
  ddply( .(RecordedDate), summarize,
         Rate_PSS10_UCLA1=mean(Scale_PSS10_UCLA_1,na.rm=TRUE),
         Rate_PSS10_UCLA2=mean(Scale_PSS10_UCLA_2,na.rm=TRUE),
         Rate_PSS10_UCLA3=mean(Scale_PSS10_UCLA_3,na.rm=TRUE),
         Rate_PSS10_UCLA4=mean(Scale_PSS10_UCLA_4,na.rm=TRUE),
         Rate_PSS10_UCLA5=mean(Scale_PSS10_UCLA_5,na.rm=TRUE),
         Rate_PSS10_UCLA6=mean(Scale_PSS10_UCLA_6,na.rm=TRUE),
         Rate_PSS10_UCLA7=mean(Scale_PSS10_UCLA_7,na.rm=TRUE),
         Rate_PSS10_UCLA8=mean(Scale_PSS10_UCLA_8,na.rm=TRUE),
         Rate_PSS10_UCLA9=mean(Scale_PSS10_UCLA_9,na.rm=TRUE),
         Rate_PSS10_UCLA10=mean(Scale_PSS10_UCLA_10,na.rm=TRUE))%>%
  mutate(total_stress = rowMeans(select(., -RecordedDate)))
```

```{r plotstressovertime, fig.cap="Levels of stress during the first weeks of the pandemic"}
ggplot(eu_stress_2months, aes(RecordedDate, total_stress)) + 
  geom_point(size=7) + 
  geom_segment(aes(x=RecordedDate, 
                   xend=RecordedDate, 
                   y=0, 
                   yend=total_stress)) + 
  ylim(0,4)+
  scale_x_date(date_breaks = "1 months", date_labels = "%B") +
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y = "Mean of stress levels")+
  theme(axis.title.y = element_text(margin=margin(r=5), hjust = 0.5, size=10),axis.title.x=element_blank(),
        axis.text.x=element_text(size=10,vjust=0.5,hjust = 1.25),axis.ticks = element_blank(),
        axis.line.y = element_line(size = 0.5),axis.text.y = element_text(size=10,vjust=0.5,hjust = 1.25))

```
Level of stress remained fairly stable over the middle of April, with a negligible decrease in the second half of the month. Notably, stress level increased at the end of May and that is odd because with the beginning of summer, people should be less stressed. We do not have any data that will confirm this trend.

# Geo Map of stress level

## Visualizing a detailed map of stress level in Europe.
```{r map, fig.cap="Levels of stress during the first weeks of the pandemic, based on PSS Scale", fig.align='center'}
worldMap <- getMap()
## identify EU countries
show <- which(worldMap$NAME %in% eu_stress$Country)

## WORLD coordinates
## this will be used as the background and will include non EU countries
plotCoords <-
  lapply(seq(worldMap$NAME),
         function(x) {
           ## collect long/lat in dataframe
           df <- lapply(worldMap@polygons[[x]]@Polygons,
                        function(x) x@coords)
           df <- do.call("rbind", as.list(df))
           df <- data.frame(df)
           
           ## add geographical name
           df$region <- as.character(worldMap$NAME[x])
           if (is.na(worldMap$NAME[x])) df$region <- "NONAME"
           
           ## add unique polygon identifier
           id <-
             rep(seq_along(worldMap@polygons[[x]]@Polygons),
                 sapply(worldMap@polygons[[x]]@Polygons,
                        function(x) nrow(x@coords)))
           df$group <- paste0(df$region, id)
           
           ## add column names and return dataframe
           colnames(df) <- list("long", "lat", "region", "group")
           return(df)
         })
plotCoords <- do.call("rbind", plotCoords)

## add EU identifier
plotCoords$EU <- 0
plotCoords$EU[which(plotCoords$region %in% eu_stress$Country)] <- 1

## for some reason, this group gives a horizontal segment across Europe
plotCoords <- plotCoords[plotCoords$group != "United States4", ]

## EU coordinates
showCoords <-
  lapply(show,
         function(x) {
           ## collect long/lat in dataframe
           df <- lapply(worldMap@polygons[[x]]@Polygons,
                        function(x) x@coords)
           df <- do.call("rbind", as.list(df))
           df <- data.frame(df)
           
           ## add geographical name
           df$region <- as.character(worldMap$NAME[x])
           if (is.na(worldMap$NAME[x])) df$region <- "NONAME"
           
           ## add unique polygon identifier
           id <-
             rep(seq_along(worldMap@polygons[[x]]@Polygons),
                 sapply(worldMap@polygons[[x]]@Polygons,
                        function(x) nrow(x@coords)))
           df$group <- paste0(df$region, id)
           
           ## add column names and return dataframe
           colnames(df) <- list("long", "lat", "region", "group")
           return(df)
         })
showCoords <- do.call("rbind", showCoords)

## add total stress level category
showCoords$total_stress<-
  eu_stress$total_stress[match(showCoords$region, eu_stress$Country)]
showCoords$total_stress <-as.numeric(showCoords$total_stress, unique(showCoords$total_stress))

#ggploting
ggplot() +
  geom_polygon(
    data = plotCoords,
    aes(x = long, y = lat, group = group),
    fill = "lightgrey", colour = "darkgrey", size = 0.1) +
  geom_polygon(
    data = showCoords,
    aes(x = long, y = lat, group = group, fill = total_stress),
    colour = "black", size = 0.1) +
  scale_fill_continuous(high = "#003e4c", low = "#4797a7", name="Stress levels")+
  scale_x_continuous(element_blank(), breaks = NULL) +
  scale_y_continuous(element_blank(), breaks = NULL) +
  coord_map(xlim = c(-26, 47),  ylim = c(32.5, 73))
```

# Sources of Distress 

The analysis will focus on the **cause** of stress of the respondents, obtaining the data through asking them questions regarding various factors that represent a source of stress.

```{r stress source, echo=TRUE}
eu_stress_source <- select(EU, Expl_Distress_1:Expl_Distress_24)%>%
                    na.omit()

eu_stress_source = data.frame(apply(eu_stress_source,2,function(x)mean(x[x<99]))) %>%
  tibble::rownames_to_column(var = "col1") %>%
  `colnames<-`(c("stress_source", "mean")) 
 
listlab<-(c("No religious activities", "Not knowing how to stop covid-19",
            "Feeling ashamed for acting differently","Adapt work to Digital Platforms",
            "Access to necessities(food etc..)","Behavior of adults I live with",
            "Behavior of childrens I live with","Adapt to social life on digital platforms",
            "No trovels outside my Country","Loneliness","Time i spend in proximity to others",
            "Children's education","Civil services(Police,sanitations..)","Income",
            "Not knowing about developments with Covid-19","Time I spend inside","Work",
            "Job prospect","No social activities","Worry over friends and relatives who live far away",
            "Not knowing how long the measures will last","Risk of catching covid-19",
            "Risk of being hospedalized or dying","National economy"))
```

```{r stress source plot, fig.cap="Sources of Distress among Europeans during the COVID-19 Pandemic", fig.align='center'}
ggplot(eu_stress_source, aes(reorder(stress_source,mean), mean)) +
  geom_col(fill= "#006978")+
  ylim(0,6)+
  coord_flip()+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  scale_x_discrete(label  = listlab)+
  labs(y="Mean" )+
  theme(axis.line.y = element_line(size = 0.5), axis.text.x=element_text(size=10),axis.title.y=element_blank(),
        axis.title.x =  element_text(margin = margin(t = 5),hjust = 0.53),
        axis.text.y=element_text(size=8))
```
The results indicate that most respondents are concerned about the state of the **national economy**. Economic considerations were followed closely by health-related risks, such as the risks of being hospitalised and of contracting the new disease.

# Trust in institutions
Partecipants were asked how much they trusted six major **institutions** in relation to the Covid-19 emergency
(on a scale from 1 = not at all to 10 = completely), in particular partecipants were asked about their trust
towards World Health Organization (WHO), the national governments’ efforts to tackle the COVID19, the Police,
the civil service, the national government and the healthcare systems.

[Here](https://www.oecd.org/governance/oecd-guidelines-on-measuring-trust-9789264278219-en.htm) there are **OECD guidelines** on measuring institutions trust.

```{r trust, echo=TRUE}
eu_trust <- select(EU, OECD_insititutions_1:OECD_insititutions_6)%>%
  na.omit()

eu_trust = data.frame(apply(eu_trust,2,function(x)mean(x))) %>%
  tibble::rownames_to_column(var = "col1") %>%
  `colnames<-`(c("trust", "mean")) 
lablist<-(c("Country's Governments","Country's civil Service","Country's Police",
            "Governments effort against covid-19","WHO","Country's Healthcare system"))
```

```{r trustplot, fig.cap="Trust in Institutions"}
ggplot(eu_trust, aes(reorder(trust,mean), mean)) +
  geom_col(fill= "#006978")+
  ylim(0,10)+
  coord_flip()+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
 scale_x_discrete(label  = lablist)+
  labs(y="Mean" )+
  theme(axis.line.y = element_line(size = 0.5), axis.text.x=element_text(size=10),axis.title.y=element_blank(),
        axis.title.x =  element_text(margin = margin(t = 5)),
        axis.text.y=element_text(size=8))
```
Europeans reported only **medium** level of trust at all, with the highest levels of confidence for their countries’ healthcare system and the WHO.
Notably, Countries governments reported the lowest level of trust.

## How much citizens trust their own governments?
```{r trustoecd1, echo="TRUE"}

eu_mean_oecd1 <- select(EU,Country,OECD_insititutions_1) %>%
  ddply( .(Country), summarize,
         Rate_OECD_insititutions_1=mean(OECD_insititutions_1,na.rm=TRUE))%>%
        arrange(desc( Rate_OECD_insititutions_1))
```

```{r trustoecd1plot, fig.cap="Trust towards governments"}
ggplot(eu_mean_oecd1, aes(reorder(Country,Rate_OECD_insititutions_1),
                          Rate_OECD_insititutions_1 )) +
  geom_col(fill= "#006978")+
  ylim(0,10)+
  coord_flip()+
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y="Mean")+
  theme(axis.line.y = element_line(size = 0.5), axis.text.x=element_text(size=10),axis.title.y=element_blank(),
        axis.title.x =  element_text(margin = margin(t = 5)),
        axis.text.y=element_text(size=10))
```

Notably, **Poland** is the most stressed Nation but it is also 
one of the country in which the population trust least in their own government.
**Finland**, on the other hand, is the nation with the least stress related to Covid,
and it is also one of the countries in which the population places an high level of compliance for their own government.

## How much citizens trust the government’s effort to handle the pandemic?
```{r trustoecd4, echo="TRUE"}
 
 eu_mean_oecd4 <- select(EU,Country,OECD_insititutions_4) %>%
   ddply( .(Country), summarize,
          Rate_OECD_insititutions_4=mean(OECD_insititutions_4,na.rm=TRUE))%>%
   arrange(desc( Rate_OECD_insititutions_4))
```
 
```{r trustoecd4plot, fig.cap="Trust towards government’s effort to handle Coronavirus"}
 ggplot(eu_mean_oecd4, aes(reorder(Country,Rate_OECD_insititutions_4),
                           Rate_OECD_insititutions_4 )) +
   geom_col(fill= "#006978")+
   ylim(0,10)+
   coord_flip()+
   theme_economist(dkpanel=TRUE) +
   scale_colour_economist()+
   labs(y="Mean")+
   theme(axis.line.y = element_line(size = 0.5), axis.text.x=element_text(size=10),axis.title.y=element_blank(),
         axis.title.x =  element_text(margin = margin(t = 5)),
         axis.text.y=element_text(size=10))
 ```
 Similar patterns as the trust level in the governments, with **Bulgaria** that reported the lowest level of 
 trust for the national effort to handle the pandemic.
 
# Trust in Countries' Measure
It was also asked participants to judge the **appropriateness
of the countries’ measures** in response to the COVID-19 on a scale from 0 (too little),
to 5 (appropriate, the black dashed line in the graph), to 10 (too much).

```{r trustinc, echo=TRUE}
eu_trustinc <- select(EU,Country,Trust_countrymeasure) %>%
  group_by(Country) %>%
  dplyr::summarize(Mean = mean(Trust_countrymeasure, na.rm=TRUE))
```

```{r trustincplot, fig.cap="Appropriateness of the countries’ measures"}
ggplot(eu_trustinc, aes(reorder(Country, Mean), Mean)) +
  geom_col(fill="#006978")+
  ylim(0,8)+
  geom_hline(yintercept=5)+
  coord_flip()+
theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y="Mean")+
  theme(axis.line.y = element_line(size = 0.5), axis.text.x=element_text(size=10),
        axis.title.y =  element_blank(),
        axis.title.x =  element_text(margin = margin(t = 5)),
        axis.text.y=element_text(size=10))
        
```
**Slovakia** and **Slovenia** were those countries where citizens considered the measures stronger than necessary; in the plot, the vertical mid-line indicates that the measures are appropriate.
**France** and **Hungary** citizens judged their governments’response less than appropriate.

### There is correlation between confidence in the measures taken by governments to tackle covid and the actions that the population has taken to reduce transmission?

```{r confcorr, echo=TRUE}
eu_conf_corr <- select(EU,Country,OECD_insititutions_6,Compliance_1:Compliance_6) %>%
                ddply( .(Country), summarize,
         Rate_OECD=mean(OECD_insititutions_6,na.rm=TRUE),
         Rate_Compliance_1=mean(Compliance_1,na.rm=TRUE),
         Rate_Compliance_2=mean(Compliance_2,na.rm=TRUE),
         Rate_Compliance_3=mean(Compliance_3,na.rm=TRUE),
         Rate_Compliance_4=mean(Compliance_4,na.rm=TRUE),
         Rate_Compliance_5=mean(Compliance_5,na.rm=TRUE))%>%
  mutate(total_Compl = rowMeans(select(., -Country,-Rate_OECD)))
```

```{r mod, echo=TRUE}
mod = lm( total_Compl ~Rate_OECD, data = eu_conf_corr)
summary(mod)
mod$coefficients
```

```{r confcorrplot, fig.cap="Trust towards the governments’handling of the pandemic"}
ggplot(eu_conf_corr, aes(Rate_OECD,total_Compl)) + 
  geom_point() +
  geom_label_repel(aes(label = Country),
                   size=2,
                   box.padding   = unit(0.5, "lines"), 
                   point.padding = 0.5,
                   min.segment.length = 0,
                   segment.color = 'grey50') +
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y="Mean of Compliances", x="Mean of trust towards governments efforts")+
  theme(axis.line.y = element_line(size = 0.5), axis.text.x=element_text(size=10),
       axis.title.y =  element_text(margin = margin(r = 5)),
       axis.title.x =  element_text(margin = margin(t = 5)),
       axis.text.y=element_text(size=10))+
  geom_abline(intercept = mod$coefficients[1], 
              slope = mod$coefficients[2], 
              color = "red")
```
From what emerges **Poland** not having confidence in the measures taken
by governments and does not even try to reduce transmission,
while **Denmark** is in the opposite situation.
In countries with higher trust towards governments ’efforts, citizens were also more 
likely to report higher levels of compliance with directives aimed at controlling the 
spread of the virus. Notably, **Portugal** reported higher levels of compliance than the model  would predict based on the acceptance of government efforts. An outlier in the other direction, Latvia reported lower levels of compliance than those the model predicted, given levels of trust.

## Will be government’s effort to handle Coronavirus more trusted over the time?
```{r trust2m, echo=TRUE}
eu_trust2m <- select(filter(EU,RecordedDate=="2020-03-30"|
                       RecordedDate=="2020-04-06"|
                       RecordedDate=="2020-04-12"|
                       RecordedDate=="2020-04-18"|
                       RecordedDate=="2020-04-24"|
                       RecordedDate=="2020-04-30"|
                       RecordedDate=="2020-05-05"|
                       RecordedDate=="2020-05-11"|
                       RecordedDate=="2020-05-17"|
                       RecordedDate=="2020-05-23"|
                       RecordedDate=="2020-05-30"),RecordedDate,OECD_insititutions_6) %>%
  ddply( .(RecordedDate), summarize,
         Rate_OECD=mean(OECD_insititutions_6,na.rm=TRUE))
```

```{r trust2mplot, fig.cap="Trust towards the governments’handling of the pandemic over the first weeks"}
ggplot(eu_trust2m, aes(RecordedDate, Rate_OECD)) + 
  geom_point(size=7) + 
  geom_segment(aes(x=RecordedDate, 
                   xend=RecordedDate, 
                   y=0, 
                   yend=Rate_OECD)) + 
  ylim(0,10)+
  scale_x_date(date_breaks = "1 months", date_labels = "%B") +
  theme_economist(dkpanel=TRUE) +
  scale_colour_economist()+
  labs(y = "Mean of trust towards governemts efforts")+
  theme(axis.title.y = element_text(size = 10),axis.title.x=element_blank(),
        axis.text.x=element_text(size=10,vjust=0.5,hjust = 1.25),axis.ticks = element_blank(),
        axis.line.y = element_line(size = 0.5),axis.text.y = element_text(size=10,vjust=0.5,hjust = 1.25))

```
In the first month the trust for government’s effort to handle Coronavirus 
appears to increase, as a result of more stringent measures. With the **beginning of the summer season** trust level appears to decrease;
probably because in many countries, including ours, Italy, the measures were almost null.

# Conclusions

```{r trustcorrplot, fig.cap="Correlation between level of stress and trust in governments"}
p <- merge(eu_stress,eu_mean_oecd1)
ggplot(data=p, aes(x=Country)) +
  geom_bar(aes(y=Rate_OECD_insititutions_1,fill=total_stress), stat="identity", position ="identity") +
  coord_flip()+
  theme_economist(dkpanel=TRUE) +
  labs(y = "Trust in governments")+
  theme(axis.title.x = element_text(size = 15,margin=margin(t=5)),axis.title.y=element_blank(),
        axis.text.y = element_text(size = 9),legend.text.align = 0.5,axis.text.x = element_text(size = 10),
        legend.text = element_blank(),legend.key.width=unit(0.5,"cm"),legend.position="right",
        legend.title=element_text(size=10))+
  scale_fill_continuous(high = "#003e4c", low = "#4797a7", name="Stress level")+
  guides(fill = guide_colourbar(title.position = "top",
                                title.hjust = .5))

```

In conclusions, **Student** is the most stressed category, as expected due to isolation and social distancing;
Poland is the most stressed Nation in Europe and as reported in [this](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7532061/)
article Polish University's Students recorded an highly level of stress during the Covid-19 pandemic.
**Women** results more stressed than men, as stated in [this](https://psycnet.apa.org/record/1999-10525-006)
Psychological article.
Remarkably, around the Europe the **Country's healthcare system** is trusted followed by the **WHO**. 
There is a strong correlation between an high level of stress and a lack of trust in governments, indeed citizens of northern Europe's countries are less stressed and they are also the same ones with an high level of compliance for their governments.

# Presentation
Click [**Here**]( ./presentation.html ) to start.

# About

**Author of this project**: Andrea Turchet <br>
**Author of the original work**: The Covidistress Team <br>
- Andrea's [GitHub](https://github.com/AndreaTurchet) <br>
- Covidistress [GitHub](https://github.com/COVIDiSTRESS) <br>
- Original [report](https://osf.io/v6wgx/) 
